==============================================
BraTS 2D U-Net (Flower Federated)
Job ID: 21237261
Node(s): gpu-q-10
Workdir: /home/bk489/federated/federated-thesis
Script:  /home/bk489/federated/federated-thesis/federated_unet/unet/unet_flower_train.py
Config:  /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedavg.yaml
Data:    /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Parts:   /home/bk489/federated/federated-thesis/data/partitions/federated_clients_5_lgg_hgg/client_data
Python:  /home/bk489/.conda/envs/fed/bin/python
Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) 
[GCC 11.3.0]
PyTorch 2.8.0+cu128 CUDA available: True CUDA: 12.8
Device count: 1
Flower 1.23.0
Sun Jan 25 22:09:54 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                    0 |
| N/A   37C    P0             70W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==============================================
Num global npz files:
3680
Example global npz files:
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_091_rank03.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_094_rank08.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_087_rank04.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_093_rank06.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_089_rank01.npz
Client partition sanity check:
  client_0: 570 slices
  client_1: 570 slices
  client_2: 630 slices
  client_3: 570 slices
  client_4: 600 slices
Starting federated U-Net training...

======================================================================
Flower BraTS 2D U-Net Federated Simulation
======================================================================
Config: /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedavg.yaml
Partitions: /home/bk489/federated/federated-thesis/data/partitions/federated_clients_5_lgg_hgg/client_data
Global data: /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Strategy: FEDAVG 
Clients: 5 | Rounds: 50 | Fraction fit: 1.0
Local epochs: 1 | Batch: 4 | LR: 0.001
Device: cuda
Eval split per round: val
Output: /home/bk489/federated/federated-thesis/results/unet_flower
Run name: fedavg_5clients_lgg_hgg
======================================================================

Centralized val slices: 370
[Round 00] global-val loss 2.2381 meanDice 0.0224 (WT 0.0000 TC 0.0027 ET 0.0645)
[Round 01] global-val loss 1.0845 meanDice 0.2781 (WT 0.7592 TC 0.0108 ET 0.0645)
[Round 02] global-val loss 0.7193 meanDice 0.5828 (WT 0.7668 TC 0.4281 ET 0.5535)
[Round 03] global-val loss 0.6744 meanDice 0.6380 (WT 0.8166 TC 0.4844 ET 0.6131)
[Round 04] global-val loss 0.5225 meanDice 0.7384 (WT 0.8823 TC 0.6282 ET 0.7046)
[Round 05] global-val loss 0.5758 meanDice 0.7071 (WT 0.8581 TC 0.5759 ET 0.6873)
[Round 06] global-val loss 0.4965 meanDice 0.7517 (WT 0.8695 TC 0.6558 ET 0.7299)
[Round 07] global-val loss 0.5124 meanDice 0.7529 (WT 0.8697 TC 0.6478 ET 0.7412)
[Round 08] global-val loss 0.5356 meanDice 0.7307 (WT 0.8674 TC 0.6128 ET 0.7120)
[Round 09] global-val loss 0.6005 meanDice 0.6875 (WT 0.8381 TC 0.5502 ET 0.6740)
[Round 10] global-val loss 0.4215 meanDice 0.8017 (WT 0.8977 TC 0.7325 ET 0.7749)
[Round 11] global-val loss 0.4558 meanDice 0.7711 (WT 0.8868 TC 0.6817 ET 0.7449)
[Round 12] global-val loss 0.4013 meanDice 0.8100 (WT 0.8937 TC 0.7496 ET 0.7865)
[Round 13] global-val loss 0.4143 meanDice 0.7899 (WT 0.8751 TC 0.7300 ET 0.7645)
