==============================================
BraTS 2D U-Net (Flower Federated)
Job ID: 21237167
Node(s): gpu-q-3
Workdir: /home/bk489/federated/federated-thesis
Script:  /home/bk489/federated/federated-thesis/federated_unet/unet/unet_flower_train.py
Config:  /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedprox.yaml
Data:    /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Parts:   /home/bk489/federated/federated-thesis/data/partitions/federated_clients_5_lgg_hgg/client_data
Python:  /home/bk489/.conda/envs/fed/bin/python
Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) 
[GCC 11.3.0]
PyTorch 2.8.0+cu128 CUDA available: True CUDA: 12.8
Device count: 1
Flower 1.23.0
Sun Jan 25 21:54:45 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                    0 |
| N/A   38C    P0             68W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==============================================
Num global npz files:
3680
Example global npz files:
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_091_rank03.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_094_rank08.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_087_rank04.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_093_rank06.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_089_rank01.npz
Client partition sanity check:
  client_0: 570 slices
  client_1: 570 slices
  client_2: 630 slices
  client_3: 570 slices
  client_4: 600 slices
Starting federated U-Net training...

======================================================================
Flower BraTS 2D U-Net Federated Simulation
======================================================================
Config: /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedprox.yaml
Partitions: /home/bk489/federated/federated-thesis/data/partitions/federated_clients_5_lgg_hgg/client_data
Global data: /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Strategy: FEDPROX (mu=0.01)
Clients: 5 | Rounds: 2 | Fraction fit: 1.0
Local epochs: 1 | Batch: 4 | LR: 0.001
Device: cuda
Eval split per round: val
Output: /home/bk489/federated/federated-thesis/results/unet_flower
Run name: fedprox_5clients_lgg_hgg_mu0p01
======================================================================

Centralized val slices: 370
[Round 00] global-val loss 2.3301 meanDice 0.0217 (WT 0.0003 TC 0.0002 ET 0.0645)
[Round 01] global-val loss 1.0740 meanDice 0.1993 (WT 0.5179 TC 0.0129 ET 0.0672)
