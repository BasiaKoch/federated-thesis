==============================================
BraTS 2D U-Net FEDERATED (70/30)
Job ID:    21345960
Node(s):   gpu-q-27
Workdir:   /home/bk489/federated/federated-thesis
Script:    /home/bk489/federated/federated-thesis/federated_unet/unet/unet_flower_train_70_30.py
Partitions:/home/bk489/federated/federated-thesis/data/partitions/brats2d_one_slice_per_patient_clients
Out base:  /home/bk489/federated/federated-thesis/results/federated/clients_2_70_30
Strategy:  fedavg (mu=0.1)
Rounds:    10 | LocalEpochs: 1
Batch:     4 | LR: 1e-3 | Seed: 42
Python:    /home/bk489/.conda/envs/fed/bin/python
Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) 
[GCC 11.3.0]
PyTorch 2.8.0+cu128 CUDA: 12.8 CUDA available: True Device count: 1
Flower 1.23.0
Tue Jan 27 11:23:33 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:C1:00.0 Off |                    0 |
| N/A   31C    P0             63W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==============================================
Client partition sanity check:
  client_0: train=206 val=37 test=37
  client_1: train=89 val=37 test=37
Starting federated training...
[Round 0] Client0 Mean=0.0261 | Client1 Mean=0.0261 | Pooled Mean=0.0244
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=1.4288, dice=0.0754
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=1.5035, dice=0.0775
[Round 1] Client0 Mean=0.0477 | Client1 Mean=0.0477 | Pooled Mean=0.0462
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=1.2149, dice=0.1044
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=1.2728, dice=0.1015
[Round 2] Client0 Mean=0.0684 | Client1 Mean=0.0684 | Pooled Mean=0.0665
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=1.0295, dice=0.1615
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=1.0813, dice=0.1460
[Round 3] Client0 Mean=0.1402 | Client1 Mean=0.1402 | Pooled Mean=0.1382
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.9083, dice=0.2280
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.8773, dice=0.2420
[Round 4] Client0 Mean=0.1608 | Client1 Mean=0.1608 | Pooled Mean=0.1617
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.7484, dice=0.3335
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.7763, dice=0.3184
[Round 5] Client0 Mean=0.1343 | Client1 Mean=0.1343 | Pooled Mean=0.1397
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.6869, dice=0.3891
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.6436, dice=0.4225
[Round 6] Client0 Mean=0.1176 | Client1 Mean=0.1176 | Pooled Mean=0.1223
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.5800, dice=0.4833
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.5652, dice=0.4930
[Round 7] Client0 Mean=0.4542 | Client1 Mean=0.4542 | Pooled Mean=0.4440
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.5370, dice=0.5215
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.5087, dice=0.5474
[Round 8] Client0 Mean=0.3116 | Client1 Mean=0.3116 | Pooled Mean=0.3180
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.4976, dice=0.5607
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.4795, dice=0.5755
[Round 9] Client0 Mean=0.4817 | Client1 Mean=0.4817 | Pooled Mean=0.4786
[36m(ClientAppActor pid=1033814)[0m   [Client 1] Epoch 1/1: loss=0.4554, dice=0.6001
[36m(ClientAppActor pid=1033814)[0m   [Client 0] Epoch 1/1: loss=0.4558, dice=0.5976
[Round 10] Client0 Mean=0.3452 | Client1 Mean=0.3452 | Pooled Mean=0.3547

============================================================
FEDERATED TRAINING COMPLETE - Per-Client Results
============================================================
Client 0 (global model): Final Mean Dice = 0.3452, Best = 0.4817
Client 1 (global model): Final Mean Dice = 0.3452, Best = 0.4817
Pooled (global model):   Final Mean Dice = 0.3547, Best = 0.4786
============================================================

Saved: /home/bk489/federated/federated-thesis/results/federated/clients_2_70_30/fedavg_mu0.0_R10_E1_20260127_112412/results.json
Saved final global model: /home/bk489/federated/federated-thesis/results/federated/clients_2_70_30/fedavg_mu0.0_R10_E1_20260127_112412/global_model.pt
Saved training log: /home/bk489/federated/federated-thesis/results/federated/clients_2_70_30/fedavg_mu0.0_R10_E1_20260127_112412/training_log.txt
Done. Results in: /home/bk489/federated/federated-thesis/results/federated/clients_2_70_30
