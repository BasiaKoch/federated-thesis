==============================================
BraTS 2D U-Net (Flower Federated)
Job ID: 21238055
Node(s): gpu-q-10
Workdir: /home/bk489/federated/federated-thesis
Script:  /home/bk489/federated/federated-thesis/federated_unet/unet/unet_flower_train_10clients.py
Config:  /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedavg_10clients.yaml
Data:    /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Parts:   /home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data
Python:  /home/bk489/.conda/envs/fed/bin/python
Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) 
[GCC 11.3.0]
PyTorch 2.8.0+cu128 CUDA available: True CUDA: 12.8
Device count: 1
Flower 1.23.0
Sun Jan 25 23:45:22 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                    0 |
| N/A   35C    P0             65W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==============================================
Num global npz files:
3680
Example global npz files:
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_091_rank03.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_094_rank08.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_087_rank04.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_093_rank06.npz
/home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz/test/BraTS20_Training_053/slice_089_rank01.npz
Client partition sanity check:
  client_0_HGG_full: 0 slices
  client_1_LGG_full_small: 0 slices
  client_2_HGG_T1ce_big: 0 slices
  client_3_HGG_FLAIR: 0 slices
  client_4_LGG_T2: 0 slices
  client_5_HGG_T1_T1ce: 0 slices
  client_6_mixed_T2_FLAIR: 0 slices
  client_7_mixed_3mods_noCE: 0 slices
  client_8_HGG_tiny_full: 0 slices
  client_9_mixed_per_sample: 0 slices
Starting federated U-Net training...

================================================================================
Flower BraTS 2D U-Net Federated Simulation (robust client naming)
================================================================================
Config: /home/bk489/federated/federated-thesis/federated_unet/unet/configs/unet_fedavg_10clients.yaml
Partitions: /home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data
Global data: /home/bk489/federated/federated-thesis/data/brats2020_top10_slices_split_npz
Strategy: FEDAVG 
Clients: 10 | Rounds: 50 | Fraction fit: 1.0
Local epochs: 1 | Batch: 4 | LR: 0.001
Device: cuda
Eval split per round: val
Output: /home/bk489/federated/federated-thesis/results/unet_flower
Run name: fedavg_10clients_mixed

Client mapping (cid -> folder):
  cid 0: client_0_HGG_full  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_0_HGG_full/train)
  cid 1: client_1_LGG_full_small  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_1_LGG_full_small/train)
  cid 2: client_2_HGG_T1ce_big  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_2_HGG_T1ce_big/train)
  cid 3: client_3_HGG_FLAIR  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_3_HGG_FLAIR/train)
  cid 4: client_4_LGG_T2  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_4_LGG_T2/train)
  cid 5: client_5_HGG_T1_T1ce  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_5_HGG_T1_T1ce/train)
  cid 6: client_6_mixed_T2_FLAIR  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_6_mixed_T2_FLAIR/train)
  cid 7: client_7_mixed_3mods_noCE  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_7_mixed_3mods_noCE/train)
  cid 8: client_8_HGG_tiny_full  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_8_HGG_tiny_full/train)
  cid 9: client_9_mixed_per_sample  (train_dir=/home/bk489/federated/federated-thesis/data/partitions/federated_clients_10_mixed/client_data/client_9_mixed_per_sample/train)
================================================================================

Centralized val slices: 370
