==============================================
Flower MNIST 2-Digit - FedProx
Job ID: 21036487
Node(s): gpu-q-23
Python: /home/bk489/.conda/envs/fed/bin/python
Python 3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) 
[GCC 11.3.0]
PyTorch 2.8.0+cu128 CUDA available: True
Flower 1.23.0
Fri Jan 23 13:43:59 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                    0 |
| N/A   39C    P0             67W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==============================================
Rounds: 30
Clients: 10
mu: 1.0
fraction_fit: 0.5
local_epochs: 5
lr: 0.05
seed: 42
Results dir: /home/bk489/federated/federated-thesis/results/flower_mnist_2digits
==============================================
Starting Flower FedProx run: fedprox_r30_mu1.0_ff0.5_e5_lr0.05_s42

============================================================
Flower MNIST 2-Digit Federated Learning Experiment
============================================================
Strategy: FEDPROX
Proximal mu: 1.0
Clients: 10
Rounds: 30
Local epochs: 5
Learning rate: 0.05
Device: cuda
Output dir: /home/bk489/federated/federated-thesis/results/flower_mnist_2digits
Run name: fedprox_r30_mu1.0_ff0.5_e5_lr0.05_s42
============================================================

  [Round 0] Global Test - Loss: 2.3058, Accuracy: 0.1111
  [Round 1] Global Test - Loss: 2.2130, Accuracy: 0.1852
  [Round 2] Global Test - Loss: 2.0742, Accuracy: 0.2972
  [Round 3] Global Test - Loss: 2.1024, Accuracy: 0.2406
  [Round 4] Global Test - Loss: 1.5576, Accuracy: 0.4731
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.398934 (should be SMALLER with higher mu)
  [Round 5] Global Test - Loss: 1.3943, Accuracy: 0.4774
  [Round 6] Global Test - Loss: 1.2644, Accuracy: 0.5622
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.131420 (should be SMALLER with higher mu)
  [Round 7] Global Test - Loss: 1.3162, Accuracy: 0.6439
  [Round 8] Global Test - Loss: 1.0268, Accuracy: 0.6939
  [Round 9] Global Test - Loss: 1.0977, Accuracy: 0.5806
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=1.355785 (should be SMALLER with higher mu)
  [Round 10] Global Test - Loss: 1.0719, Accuracy: 0.6746
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.146446 (should be SMALLER with higher mu)
  [Round 11] Global Test - Loss: 1.1002, Accuracy: 0.6203
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.081340 (should be SMALLER with higher mu)
  [Round 12] Global Test - Loss: 1.1024, Accuracy: 0.6574
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.048824 (should be SMALLER with higher mu)
  [Round 13] Global Test - Loss: 0.9980, Accuracy: 0.6356
  [Round 14] Global Test - Loss: 0.7445, Accuracy: 0.7802
  [Round 15] Global Test - Loss: 0.6562, Accuracy: 0.8005
  [Round 16] Global Test - Loss: 0.7727, Accuracy: 0.7252
  [Round 17] Global Test - Loss: 0.7988, Accuracy: 0.7241
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.115816 (should be SMALLER with higher mu)
  [Round 18] Global Test - Loss: 0.8666, Accuracy: 0.7125
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.066178 (should be SMALLER with higher mu)
  [Round 19] Global Test - Loss: 0.6669, Accuracy: 0.7868
  [Round 20] Global Test - Loss: 0.7443, Accuracy: 0.7387
  [Round 21] Global Test - Loss: 0.4990, Accuracy: 0.8487
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.089758 (should be SMALLER with higher mu)
  [Round 22] Global Test - Loss: 0.5973, Accuracy: 0.7856
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.050512 (should be SMALLER with higher mu)
  [Round 23] Global Test - Loss: 0.4831, Accuracy: 0.8639
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.068924 (should be SMALLER with higher mu)
  [Round 24] Global Test - Loss: 0.4684, Accuracy: 0.8528
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.149180 (should be SMALLER with higher mu)
  [Round 25] Global Test - Loss: 0.5425, Accuracy: 0.8144
  [Round 26] Global Test - Loss: 0.6120, Accuracy: 0.7886
  [Round 27] Global Test - Loss: 0.6635, Accuracy: 0.7819
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.040461 (should be SMALLER with higher mu)
  [Round 28] Global Test - Loss: 0.6527, Accuracy: 0.8141
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] mu=1.0, local_epochs=5
[36m(ClientAppActor pid=496288)[0m   [DEBUG Client 0] drift=0.081524 (should be SMALLER with higher mu)
  [Round 29] Global Test - Loss: 0.7367, Accuracy: 0.7966
  [Round 30] Global Test - Loss: 0.6854, Accuracy: 0.8054

Results saved to: /home/bk489/federated/federated-thesis/results/flower_mnist_2digits/fedprox_r30_mu1.0_ff0.5_e5_lr0.05_s42_results.json

============================================================
EXPERIMENT SUMMARY
============================================================
Strategy: FEDPROX (mu=1.0)

--- Accuracy & Loss ---
Final Accuracy: 0.8054
Best Accuracy:  0.8639
Final Loss:     0.6854
Best Loss:      0.4684

--- Convergence (rounds to reach threshold, -1 if never) ---
Rounds to 90% accuracy: -1
Rounds to 95% accuracy: -1
Rounds to 98% accuracy: -1

--- Stability (accuracy) ---
Variance:        0.039921
Max Oscillation: 0.2325
Smoothness:      0.9439

--- Timing ---
Total Time:     1127.50s
Avg per Round:  37.58s
============================================================

Client digit pairs (train):
  client 0: digits=(0, 5)
  client 1: digits=(1, 6)
  client 2: digits=(2, 7)
  client 3: digits=(3, 8)
  client 4: digits=(4, 9)
  client 5: digits=(5, 0)
  client 6: digits=(6, 1)
  client 7: digits=(7, 2)
  client 8: digits=(8, 3)
  client 9: digits=(9, 4)
âœ… Job completed successfully!
